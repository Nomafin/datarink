<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>datarink</title>
	<link rel="icon" href="favicon.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<!-- Template for teamsViewComponent -->
	<script type="text/x-template" id="teams-view-template">
		<div>
			<div class="table-header">
				<h1>Teams: 2016-2017</h1>
				<div v-if="processedTeams.length > 0">
					<select v-model="strengthSit">
						<option value="all">All situations</option>
						<option value="ev5">5 on 5</option>
						<option value="sh">Short handed</option>
						<option value="pp">Power play</option>
					</select
					><label for="onIceGoals">
						<input type="checkbox" id="onIceGoals" v-model="visibleColumns.onIceGoals">Goals
					</label
					><label for="onIceCorsi">
						<input type="checkbox" id="onIceCorsi" v-model="visibleColumns.onIceCorsis">Corsi
					</label>
				</div>
			</div>
			<div class="loader" v-if="!processedTeams || processedTeams.length <= 0"></div>
			<div class="table-container" v-if="processedTeams.length > 0">
				<table v-bind:class="{ 'cols-on-ice-goals': visibleColumns.onIceGoals, 'cols-on-ice-corsis': visibleColumns.onIceCorsis }">
					<thead>
						<tr>
							<th @click="sortBy('team');" class="left-aligned"
								v-bind:class="[ sort.column === 'team' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Name</th>
							<th @click="sortBy('toi');"
								v-bind:class="[ sort.column === 'toi' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Mins</th>
							<th @click="sortBy('gf');" class="cols-on-ice-goals"
								v-bind:class="[ sort.column === 'gf' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>GF</th>
							<th @click="sortBy('ga');" class="cols-on-ice-goals"
								v-bind:class="[ sort.column === 'ga' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>GA</th>
							<th @click="sortBy('gDiff');" class="cols-on-ice-goals"
								v-bind:class="[ sort.column === 'gDiff' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>G diff</th>
							<th @click="sortBy('shPct');" class="cols-on-ice-goals"
								v-bind:class="[ sort.column === 'shPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Sh%</th>
							<th @click="sortBy('svPct');" class="cols-on-ice-goals"
								v-bind:class="[ sort.column === 'svPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Sv%</th>
							<th @click="sortBy('cf');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.column === 'cf' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF</th>
							<th @click="sortBy('ca');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.column === 'ca' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CA</th>
							<th @click="sortBy('cfPct');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.column === 'cfPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF%</th>
							<th @click="sortBy('cfPctAdj');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.column === 'cfPctAdj' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF%, score-adj</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="p in processedTeams">
							<td class="left-aligned">{{ p.team.toUpperCase() }}</td>
							<td>{{ Math.round(p.toi / 60) }}</td>
							<td class="cols-on-ice-goals">{{ p.gf }}</td>
							<td class="cols-on-ice-goals">{{ p.ga }}</td>
							<td class="cols-on-ice-goals">{{ p.gDiff | signed }}</td>
							<td class="cols-on-ice-goals">{{ p.shPct | percentage }}<span class="pct">%</span></td>
							<td class="cols-on-ice-goals">{{ p.svPct | percentage }}<span class="pct">%</span></td>					
							<td class="cols-on-ice-corsis">{{ p.cf }}</td>
							<td class="cols-on-ice-corsis">{{ p.ca }}</td>
							<td class="cols-on-ice-corsis">{{ p.cfPct | percentage }}<span class="pct">%</span></td>
							<td class="cols-on-ice-corsis">{{ p.cfPctAdj | percentage }}<span class="pct">%</span></td>			
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</script>
	<!-- Template for playersViewComponent -->
	<script type="text/x-template" id="players-view-template">
		<div>
			<div class="table-header">
				<h1>Skaters: 2016-2017</h1>
				<div v-if="playersWithAggregatedData">
					<select v-model="strengthSit">
						<option value="all">All situations</option>
						<option value="ev5">5 on 5</option>
						<option value="sh">Short handed</option>
						<option value="pp">Power play</option>
					</select
					><label for="individual" class="checkbox-label">
						<input type="checkbox" id="individual" v-model="visibleColumns.individual">Own production
					</label
					><label for="onIceGoals" class="checkbox-label">
						<input type="checkbox" id="onIceGoals" v-model="visibleColumns.onIceGoals">On-ice goals
					</label
					><label for="onIceCorsi" class="checkbox-label">
						<input type="checkbox" id="onIceCorsi" v-model="visibleColumns.onIceCorsis">On-ice corsi
					</label
					><div class="search-with-menu">
						<select v-model="search.col" v-on:change="search.query = '';">
							<option value="name">Name:</option>
							<option value="teams">Team:</option>
							<option value="positions">Position:</option>
						</select
						><input v-model="search.query" type="text">
					</div
					><div class="search-with-menu">
						<label for="minimum-toi">Minimum minutes:</label
						><input id="minimum-toi" v-model.number="minimumToi" type="number" style="width: 62px;">
					</div>
				</div>
			</div>
			<div class="loader" v-if="!playersWithAggregatedData"></div>
			<div class="table-container" v-if="playersWithAggregatedData">
				<table v-bind:class="{ 'cols-individual': visibleColumns.individual, 'cols-on-ice-goals': visibleColumns.onIceGoals, 'cols-on-ice-corsis': visibleColumns.onIceCorsis }">
					<thead>
						<tr>
							<th @click="sortBy('name');" class="left-aligned"
								v-bind:class="[ sort.col === 'name' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Name</th>
							<th @click="sortBy('positions');" class="left-aligned"
								v-bind:class="[ sort.col === 'positions' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Pos</th>
							<th @click="sortBy('teams');" class="left-aligned"
								v-bind:class="[ sort.col === 'teams' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Team</th>
							<th @click="sortBy('toi');"
								v-bind:class="[ sort.col === 'toi' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Mins</th>
							<th @click="sortBy('ig');" class="cols-individual"
								v-bind:class="[ sort.col === 'ig' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>G</th>
							<th @click="sortBy('ia1');" class="cols-individual"
								v-bind:class="[ sort.col === 'ia1' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>A1</th>
							<th @click="sortBy('ia2');" class="cols-individual"
								v-bind:class="[ sort.col === 'ia2' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>A2</th>
							<th @click="sortBy('ip1');" class="cols-individual"
								v-bind:class="[ sort.col === 'ip1' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>P1</th>
							<th @click="sortBy('ic');" class="cols-individual"
								v-bind:class="[ sort.col === 'ic' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>C</th>
							<th @click="sortBy('iShPct');" class="cols-individual"
								v-bind:class="[ sort.col === 'iShPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Own Sh%</th>
							<th @click="sortBy('gf');" class="cols-on-ice-goals"
								v-bind:class="[ sort.col === 'gf' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>GF</th>
							<th @click="sortBy('ga');" class="cols-on-ice-goals"
								v-bind:class="[ sort.col === 'ga' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>GA</th>
							<th @click="sortBy('gDiff');" class="cols-on-ice-goals"
								v-bind:class="[ sort.col === 'gDiff' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>G diff</th>
							<th @click="sortBy('shPct');" class="cols-on-ice-goals"
								v-bind:class="[ sort.col === 'shPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Sh%</th>
							<th @click="sortBy('svPct');" class="cols-on-ice-goals"
								v-bind:class="[ sort.col === 'svPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>Sv%</th>
							<th @click="sortBy('cf');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.col === 'cf' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF</th>
							<th @click="sortBy('ca');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.col === 'ca' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CA</th>
							<th @click="sortBy('cfPct');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.col === 'cfPct' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF%</th>
							<th @click="sortBy('cfPctRel');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.col === 'cfPctRel' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF%, rel</th>
							<th @click="sortBy('cfPctAdj');" class="cols-on-ice-corsis"
								v-bind:class="[ sort.col === 'cfPctAdj' ? (sort.order === -1 ? 'sort-desc' : 'sort-asc') : '' ]"
								>CF%, score-adj</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="p in pagePlayers">
							<td class="left-aligned">{{ p.first + " " + p.last }}</td>			
							<td class="left-aligned uppercased">{{ p.positions }}</td>
							<td class="left-aligned uppercased">{{ p.teams }}</td>
							<td>{{ Math.round(p.toi / 60) }}</td>
							<td class="cols-individual">{{ p.ig }}</td>
							<td class="cols-individual">{{ p.ia1 }}</td>
							<td class="cols-individual">{{ p.ia2 }}</td>
							<td class="cols-individual">{{ p.ip1 }}</td>
							<td class="cols-individual">{{ p.ic }}</td>
							<td class="cols-individual">{{ p.iShPct | percentage }}<span class="pct">%</span></td>
							<td class="cols-on-ice-goals">{{ p.gf }}</td>
							<td class="cols-on-ice-goals">{{ p.ga }}</td>
							<td class="cols-on-ice-goals">{{ p.gDiff | signed }}</td>
							<td class="cols-on-ice-goals">{{ p.shPct | percentage }}<span class="pct">%</span></td>
							<td class="cols-on-ice-goals">{{ p.svPct | percentage }}<span class="pct">%</span></td>					
							<td class="cols-on-ice-corsis">{{ p.cf }}</td>
							<td class="cols-on-ice-corsis">{{ p.ca }}</td>
							<td class="cols-on-ice-corsis">{{ p.cfPct | percentage }}<span class="pct">%</span></td>
							<td class="cols-on-ice-corsis">{{ p.cfPctRel | percentage | signed }}<span class="pct">%</span></td>
							<td class="cols-on-ice-corsis">{{ p.cfPctAdj | percentage }}<span class="pct">%</span></td>			
						</tr>
					</tbody>
				</table>
				<div class="pagination" v-if="pagination.total > 0">
					<!--
					<button @click="changePage(0);" class="first">
						<svg viewBox="0 0 16 16">
							<path d="M12,3,7,8l5,5L13,12,9,8,13,4Z"/>
							<rect x="4" y="3" width="1.5" height="10"/>
						</svg>
					</button>
					-->
					<button @click="pagination.current--;" class="previous">
						<svg viewBox="0 0 16 16">
							<path d="M10,3,5,8l5,5L11,12,7,8,11,4Z"/>
						</svg>
					</button
					><div>
						<span>{{ pagination.current + 1 }}</span
						><span> of </span
						><span>{{ pagination.total }}</span>
					</div
					><button @click="pagination.current++;" class="next">
						<svg viewBox="0 0 16 16">
							<path d="M10,3,5,8l5,5L11,12,7,8,11,4Z" transform="rotate(180 8 8)"/>
						</svg>
					</button>
					<!--
					<button @click="changePage(pagination.totalPages - 1);" class="last">
						<svg viewBox="0 0 16 16">
							<g transform="rotate(180 8 8)">
								<path d="M12,3,7,8l5,5L13,12,9,8,13,4Z"/>
								<rect x="4" y="3" width="1.5" height="10"/>
							</g>
						</svg>
					</button>
					-->
				</div>
			</div>
		</div>
	</script>
	<!-- Root element for application -->
	<div id="app">
		<div class="header">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
				<path class="logo-r" d="M16,8V32h8V16h8V8Z"/>
				<path class="logo-d" d="M16,24v8H0V8H16V0h8v8H16v8H8v8Z"/>
			</svg
			><router-link to="/teams">Teams</router-link
			><router-link to="/players">Skaters</router-link>
		</div>
		<router-view>
		</router-view>
	</div>
	<script src="lodash.js"></script>
	<script src="vue.js"></script>
	<script src="teams-router-view-component.js"></script>
	<script src="players-router-view-component.js"></script>
	<script src="vue-router.js"></script>
	<script src="app-constants.js"></script>
	<script src="app.js"></script>
</body>
</html>